# Dockerfile для системы учёта тренировок
# Данный файл предназначен для создания контейнера с приложением
# В качестве базового образа используется Python 3.11 на основе Alpine Linux

FROM python:3.11-alpine

# Установка рабочей директории внутри контейнера
# Все последующие команды будут выполняться из этой директории
WORKDIR /app

# Копирование файла зависимостей в контейнер
# Это делается отдельным шагом для использования кэша Docker
COPY requirements.txt .

# Установка всех необходимых зависимостей Python
# Используется pip для установки пакетов из requirements.txt
RUN pip install --no-cache-dir -r requirements.txt

# Копирование всех файлов приложения в контейнер
# Это включает код, шаблоны, статические файлы и прочее
COPY . .

# Создание директорий для работы приложения
# Необходимо для корректной работы функционала загрузки файлов и базы данных
RUN mkdir -p static/uploads && chmod 777 /app

# Открытие порта 8080 для доступа к приложению
# Данный порт будет использоваться Flask приложением
EXPOSE 8080

# Команда запуска приложения при старте контейнера
# Запускается основной файл app.py
CMD ["python", "app.py"]
