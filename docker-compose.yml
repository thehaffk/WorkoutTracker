# Docker Compose конфигурация для системы учёта тренировок
# Данный файл предназначен для упрощённого запуска приложения в контейнере
# Позволяет запустить всё приложение одной командой

version: '3.8'

services:
  # Основной сервис приложения для управления тренировками
  workout-tracker:
    # Название образа который будет создан в процессе сборки
    image: workout-tracker:latest

    # Название контейнера для удобства идентификации
    container_name: workout-tracker-app

    # Указание на сборку образа из текущей директории
    build:
      context: .
      dockerfile: Dockerfile

    # Проброс портов: внешний:внутренний
    # Приложение будет доступно на порту 8888 хостовой машины
    ports:
      - "8888:8080"

    # Подключение томов для сохранения данных
    # Загруженные файлы сохраняются вне контейнера
    volumes:
      - ./static/uploads:/app/static/uploads

    # Переменные окружения для конфигурации приложения
    environment:
      - FLASK_ENV=production
      - SECRET_KEY=production-secret-key-change-me

    # Политика перезапуска контейнера
    # always означает что контейнер будет автоматически перезапускаться
    restart: unless-stopped
